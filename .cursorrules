# Dawson-Does Framework - Cursor Rules
# Governance Version: 3.0 | Optimized for Token Efficiency
# Quick Reference: See GOVERNANCE_CARD.md for 50-line summary
# Hash: eefae7ec1d0e | If unchanged, skip re-reading governance files

---

## Bootstrap Mode (SLIM by Default)

**SLIM MODE (Default)**: Fast, efficient - skip heavy reads
**FULL MODE**: Use `[full]` prefix for complex/multi-step tasks

### Slim Bootstrap (Once Per Chat Session)

**Runs once** at the START of a new chat only (not every response):


1. **Quick Sync** (1 command):
   ```bash
   git pull origin main --quiet && git status --short
   ```

2. **Brief Acknowledgment** (3 lines max):
   ```
   ✓ Governance 3.0 | Export-first | No protected file deletion
   ✓ Mode: SLIM (use [full] for heavy tasks)
   Proceeding with task...
   ```

3. **Proceed immediately with user's request**

**DO NOT read** in slim mode:
- AGENT_CONTEXT.md (you know the rules)
- Memory files (unless resuming work)
- PROJECT_PRIORITIES.md (unless checking priorities)
- MINDFRAME.md (unless certifying)

### Full Bootstrap (Only When Requested)

If user message starts with `[full]`:

1. Run complete sync check
2. Read AGENT_CONTEXT.md
3. Read memory file for your role
4. Read PROJECT_PRIORITIES.md
5. Check inbox for pending tasks
6. Then proceed with task

**Trigger phrases for full mode:**
- `[full]` - explicit trigger
- "resume previous work" - needs memory
- "check my inbox" - needs file reads
- "what's the priority" - needs priorities file

---

## Core Rules (Always Apply)

### Philosophy
- Export-first: Everything for local ownership
- Zero lock-in: Platform optional after export

### Code Style
- JavaScript (.mjs): No semicolons, 2-space indent
- TypeScript (.ts/.tsx): Semicolons, 2-space indent
- Commits: Conventional format (feat:, fix:, docs:, chore:)

### Key Commands
```bash
npm test                    # Before committing
./scripts/checkpoint.sh     # Save work
./scripts/rotate-memory.sh  # Keep memory lean
```

### Protected Files (Never Delete)
- AGENT_CONTEXT.md, .cursorrules
- prompts/agents/memory/*.md
- prompts/agents/roles/*.md
- docs/standards/*

### What NOT to Do
- Add unrequested features
- Refactor unrelated code
- Delete protected files
- Create feature branches (work on main)
- Split fenced output blocks
- Add `# comments` in fenced command blocks for humans

### Clean Command Blocks (For Human Execution)
Fenced commands must be PURE, runnable - no comments inside:
```
❌ BAD: # Open browser
        open file.html

✅ GOOD: cd /path/to/project && open file.html
```
Explanations go OUTSIDE the fence, before it.

### Next Agent Prompt Rule (For Agent Handoffs)
Agent handoffs use relative paths (no cd prefix needed):
```
Next Agent: [Role] Agent
```
Confirm you are the [Role] Agent.
Read and execute: output/agents/[role]/inbox/TASK.txt
```
```

---

## SOP Loading (Lazy - Rec 5)

| Task Type | Read SOP? |
|-----------|-----------|
| Simple (< 3 steps) | ❌ No - use internalized knowledge |
| Complex (3+ steps) | ✅ Yes - read role SOP |
| `[full]` mode | ✅ Yes |
| Task says "follow SOP" | ✅ Yes |
| Unsure how to proceed | ✅ Yes - always safe to read |

---

## Checkpoint / Session End (Tiered)

| Tier | Trigger | Steps |
|------|---------|-------|
| Light | `cp light` | Commit + Sign off |
| Standard | `cp` | Test + Commit + Brief memory (5 lines) |
| Full | `cp full` | All: memory, MINDFRAME, SOP scan, handoff |

**Default**: Standard tier when just `cp` is used

---

## Agent Identity

End responses with role in caps: `(CLI AGENT)`, `(WEBSITE AGENT)`, etc.

---

## Token Efficiency Rules

1. **Memory files**: Keep sessions brief (5-10 lines each)
2. **Don't read files you don't need**
3. **Batch file reads** when possible
4. **Skip verification questions** in slim mode
5. **No verbose acknowledgments** - 3 lines max
6. **New rules**: See `docs/sops/GOVERNANCE_MAINTENANCE_SOP.md` before adding
