# P0 CRITICAL: ZIP Export Does Not Match AI Preview

**Priority**: P0 - CRITICAL
**Date**: 2025-12-24
**From**: Quality Agent
**Affects**: All users of the Project Configurator

---

## Problem Statement

Users configure a project through the 8-step configurator, see a fully functional 
e-commerce site in the AI Preview (with navigation, products, cart, auth buttons), 
then download a ZIP containing only a minimal Next.js starter with a placeholder page.

This is a **critical UX failure** - users expect what they previewed.

---

## Evidence

### What AI Preview Shows (Screenshot Analysis)

The AI Preview displays a complete e-commerce storefront:
- Navigation bar: Home, Products, Account, Contact, Login, Sign Up
- Hero section: "Welcome to mytestproject06" with Shop Now CTA
- Featured Products: 4 product cards with images, prices ($49.99, $29.99, $79.99, $59.99)
- Add to Cart buttons on each product
- Components listed: Nav, Features, Auth, Cart, ProductGrid

### What ZIP Download Contains

```
mytestproject06/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ globals.css        # Basic Tailwind
â”‚   â”œâ”€â”€ layout.tsx         # Minimal layout, no components
â”‚   â””â”€â”€ page.tsx           # JUST A PLACEHOLDER - "mytestproject06" text only
â”œâ”€â”€ package.json           # Dependencies listed but NOT implemented
â”œâ”€â”€ README.md              # Says "use CLI for full template"
â””â”€â”€ .dd/                   # Vision/goals captured
```

The page.tsx is literally just:
```tsx
export default function Home() {
  return (
    <main className="min-h-screen flex items-center justify-center bg-gray-900 text-white">
      <div className="text-center">
        <h1 className="text-4xl font-bold mb-4">mytestproject06</h1>
        <p className="text-gray-400 mb-8">Generated with dawson-does-framework</p>
        // ... just setup instructions, NO e-commerce components
      </div>
    </main>
  )
}
```

---

## Root Cause Analysis

The ZIP export API generates a **starter structure** regardless of:
1. Template selection (E-commerce, SaaS, Blog, etc.)
2. AI Preview generation
3. User configuration

The README.md explicitly states:
> "For full templates with pre-built components, use the CLI command"

This is problematic because:
1. Users already selected a template expecting those components
2. The AI Preview SHOWS the components, creating false expectations
3. The export step doesn't clearly explain ZIP vs CLI differences

---

## Required Fixes

### Fix 1: Template-Aware ZIP Generation

The ZIP export must include template-specific components:

| Template | Required Components |
|----------|---------------------|
| E-commerce | ProductGrid, Cart, Checkout, ProductCard, Nav, Footer |
| SaaS | PricingTable, FeatureCards, CTASection, AuthForms |
| Blog | PostList, PostCard, CategoryNav, AuthorBio |
| Landing Page | Hero, Features, Testimonials, FAQ, CTA |
| Admin Dashboard | Sidebar, DataTable, Charts, Settings |

### Fix 2: Integration Code Generation

Currently: package.json lists dependencies but NO implementation code.

Required: Generate actual integration boilerplate:

```
app/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ supabase/
â”‚   â”‚   â”œâ”€â”€ client.ts          # Supabase browser client
â”‚   â”‚   â”œâ”€â”€ server.ts          # Supabase server client
â”‚   â”‚   â””â”€â”€ middleware.ts      # Auth middleware
â”‚   â”œâ”€â”€ stripe/
â”‚   â”‚   â”œâ”€â”€ client.ts          # Stripe instance
â”‚   â”‚   â””â”€â”€ webhooks.ts        # Webhook handler
â”‚   â”œâ”€â”€ email/
â”‚   â”‚   â””â”€â”€ resend.ts          # Resend client
â”‚   â””â”€â”€ analytics/
â”‚       â””â”€â”€ posthog.ts         # PostHog provider
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ LoginForm.tsx
â”‚   â”‚   â”œâ”€â”€ SignupForm.tsx
â”‚   â”‚   â””â”€â”€ AuthProvider.tsx
â”‚   â”œâ”€â”€ cart/
â”‚   â”‚   â”œâ”€â”€ CartProvider.tsx
â”‚   â”‚   â”œâ”€â”€ CartItem.tsx
â”‚   â”‚   â””â”€â”€ CartSummary.tsx
â”‚   â””â”€â”€ products/
â”‚       â”œâ”€â”€ ProductGrid.tsx
â”‚       â”œâ”€â”€ ProductCard.tsx
â”‚       â””â”€â”€ ProductDetail.tsx
â””â”€â”€ app/
    â”œâ”€â”€ (auth)/
    â”‚   â”œâ”€â”€ login/page.tsx
    â”‚   â””â”€â”€ signup/page.tsx
    â”œâ”€â”€ products/
    â”‚   â”œâ”€â”€ page.tsx
    â”‚   â””â”€â”€ [id]/page.tsx
    â”œâ”€â”€ cart/page.tsx
    â””â”€â”€ checkout/page.tsx
```

### Fix 3: AI Preview Code Export

If AI generates a preview, that code should be exportable. Options:
1. "Export Preview Code" button that downloads the AI-generated components
2. Include AI preview code in the ZIP automatically
3. Save AI preview to .dd/preview-components/ for reference

### Fix 4: Clear Export Options

Update the Export step UI:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Choose Your Export Method                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚ â”‚ ğŸ“¦ Full Template â”‚  â”‚ ğŸš€ CLI Command  â”‚                    â”‚
â”‚ â”‚                  â”‚  â”‚                  â”‚                    â”‚
â”‚ â”‚ Complete app     â”‚  â”‚ Same as Full,    â”‚                    â”‚
â”‚ â”‚ with all         â”‚  â”‚ installed via    â”‚                    â”‚
â”‚ â”‚ components,      â”‚  â”‚ command line     â”‚                    â”‚
â”‚ â”‚ integrations,    â”‚  â”‚                  â”‚                    â”‚
â”‚ â”‚ and pages        â”‚  â”‚ Recommended for  â”‚                    â”‚
â”‚ â”‚                  â”‚  â”‚ advanced users   â”‚                    â”‚
â”‚ â”‚ [Download ZIP]   â”‚  â”‚ [Copy Command]   â”‚                    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚ â”‚ ğŸ“„ Starter Only â”‚                                         â”‚
â”‚ â”‚                  â”‚                                         â”‚
â”‚ â”‚ Minimal Next.js  â”‚                                         â”‚
â”‚ â”‚ with dependenciesâ”‚                                         â”‚
â”‚ â”‚ listed. Build    â”‚                                         â”‚
â”‚ â”‚ from scratch.    â”‚                                         â”‚
â”‚ â”‚                  â”‚                                         â”‚
â”‚ â”‚ [Download Starter]â”‚                                        â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Files to Investigate

1. `website/app/api/export/` - Export API endpoints
2. `website/lib/export/` or similar - ZIP generation logic
3. `website/app/configure/steps/ExportStep.tsx` - Export UI
4. `templates/` directory - Template source files
5. How AI Preview components are generated vs how export works

---

## Acceptance Criteria

- [ ] ZIP download includes template-specific components matching the selected template
- [ ] Integration code is generated, not just dependencies listed
- [ ] AI Preview matches downloaded code structure
- [ ] Export options clearly differentiate Full Template vs Starter
- [ ] User testing confirms expectations match reality

---

## Impact if Not Fixed

- Users lose trust in the platform
- Support burden increases ("where are my components?")
- Core value proposition undermined (configure â†’ export should work)
- AI Preview becomes meaningless if it doesn't reflect output

---

*P0 Critical Bug | Quality Agent â†’ Website Agent | 2025-12-24*

