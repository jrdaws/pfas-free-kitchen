TASK: Implement CLI `env pull` Command
PRIORITY: P1 (Core Developer Experience)
TYPE: CLI / Node.js
REFERENCE: output/shared/design/PLATFORM_ARCHITECTURE_RESEARCH.md Part D

---

## Objective

Create the `npx @jrdaws/framework env pull` command that syncs environment variables from the cloud dashboard to local `.env.local`.

## Deliverables

### 1. New CLI Command

Add to `bin/framework.js` or create `bin/commands/env.mjs`:

```bash
npx @jrdaws/framework env pull [options]

Options:
  --project <id>    Specify project ID (optional if .frameworkrc exists)
  --force           Overwrite existing .env.local
  --dry-run         Show what would be written without writing
```

### 2. Authentication Flow

1. Check for existing auth token in `~/.frameworkrc` or `~/.config/framework/auth.json`
2. If no token, prompt user to authenticate:
   ```
   No authentication found. Opening browser to authenticate...
   [Opens browser to dashboard OAuth flow]
   Waiting for authentication...
   ✓ Authenticated as user@example.com
   ```
3. Store token securely for future use

### 3. Env Pull Flow

```
$ npx @jrdaws/framework env pull

Fetching project configuration...
Project: My SaaS App

Environment Variables:
  ✓ NEXT_PUBLIC_SUPABASE_URL (from cloud)
  ✓ NEXT_PUBLIC_SUPABASE_ANON_KEY (from cloud)
  ⚠ SUPABASE_SERVICE_ROLE_KEY (placeholder - add manually)
  ⚠ STRIPE_SECRET_KEY (placeholder - add manually)

Writing to .env.local...
✓ Created .env.local with 4 variables

Next steps:
  1. Add your secret keys to .env.local
  2. Run `npm run dev` to start developing
```

### 4. Generated .env.local Format

```bash
# Generated by @jrdaws/framework env pull
# Project: My SaaS App
# Generated: 2026-01-04T12:00:00Z

# Supabase Configuration
NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhb...

# ⚠️ SECRET KEYS - Add manually (never stored in cloud)
# Get your key: https://supabase.com/dashboard/project/_/settings/api
SUPABASE_SERVICE_ROLE_KEY=

# Get your key: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
```

### 5. Additional Commands

```bash
# Check which env vars are set/missing
npx @jrdaws/framework env check

# Push public keys back to cloud (optional)
npx @jrdaws/framework env push --public-only

# List available projects
npx @jrdaws/framework projects list
```

## Technical Requirements

- Use existing CLI patterns from bin/framework.js
- Use `open` package to open browser for OAuth
- Use `conf` or similar for storing auth token
- Respect .gitignore (ensure .env.local is gitignored)
- Exit codes: 0 success, 1 error

## Security Requirements

- NEVER log secret key values
- Warn if .env.local is not gitignored
- Warn if running in CI environment

## Success Criteria

- [ ] `env pull` downloads and writes .env.local
- [ ] Auth flow works via browser OAuth
- [ ] Secret keys shown as placeholders only
- [ ] `env check` shows missing variables
- [ ] Clear error messages for common issues
- [ ] Works on macOS, Linux, Windows

## NOT in Scope

- Cloud storage of secret keys
- Vercel/GitHub secrets sync (Phase 2)
- GUI for env management

